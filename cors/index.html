<!doctype html>
<head>
  <style>
    :root {
      font-family: monospace;
      font-size: 20px;
    }
    .template {
      display: none;
    }
    input, select, option {
      font-family: monospace;
      font-size: 1rem;
    }
    input {
      border: 0;
      border-bottom: 1px solid black;
    }
  </style>
</head>
<body>
  fetch("<input type="text" id="url" placeholder="http://www.example.com">", {<br>
  &nbsp;&nbsp;"method": "
  <select id="method">
    <option selected>GET</option>
    <option>POST</option>
    <option>PUT</option>
    <option>PATCH</option>
    <option>HEAD</option>
    <option>OPTIONS</option>
  </select>",<br>
  &nbsp;&nbsp;"mode": "
  <select id="mode">
    <option selected>cors</option>
    <option>no-cors</option>
  </select>",<br>
  &nbsp;&nbsp;"headers": {<br>
    <div class="template header">
      &nbsp;&nbsp;&nbsp;&nbsp;"<input type="text" placeholder="X-Forwarded-for">": "<input type="text" placeholder="Value">",
      &nbsp;&nbsp;&nbsp;&nbsp;<button>-</button><br>
    </div>
    <div>
    &nbsp;&nbsp;&nbsp;&nbsp;<button id="addheader">+</button>
    </div>
    &nbsp;&nbsp;}<br>
  });<br>
  <div>
    <button id="send">Send Request</button>
  </div><br>
  <br>
  Response:<br>
  <pre></pre>
  <script src="fetch.js"></script>
  <script>
    (function() {
      var $ = document.querySelector.bind(document);
      var output = $('pre');
      var deleteHeaderFunc = function(ev) {
        ev.target.parentElement.parentElement.removeChild(ev.target.parentElement);
      };
      $('#addheader').addEventListener('click', function(ev) {
        var n = $('.header.template').cloneNode(true);
        n.classList.remove('template');
        n.querySelector('button').addEventListener('click', deleteHeaderFunc);
        ev.target.parentElement.parentElement.insertBefore(n, ev.target.parentElement);
      });
      $('#send').addEventListener('click', function() {
        var headers = {};
        Array.prototype.forEach.call(document.querySelectorAll('.header:not(.template)'), function(fields) {
          var header = fields.querySelector('input:nth-of-type(1)').value;
          var value = fields.querySelector('input:nth-of-type(2)').value;
          headers[header] = value;
        });
        fetch($('#url').value, {
          method: $('#method').value,
          mode: $('#mode').value,
          headers: headers,
          cache: 'no-cache'
        }).then(function(resp) {
          return resp.text();
        }).then(function(text) {
          output.innerText = text;
        }).catch(function(err) {
          output.innerText = err;
        });
      });
    })();
  </script>
</body>
